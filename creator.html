<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evoque - Creator Profile</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="app-content">
        <aside id="sidebar">
            <div class="sidebar-header">
                <img src="https://i.imgur.com/your-new-logo.png" alt="Evoque Logo" class="logo">
                <h2>Evoque</h2>
            </div>
            <nav class="nav-menu">
                <ul>
                    <li><a href="dashboard.html">Dashboard</a></li>
                    <li><a href="explore.html" class="active">Explore</a></li>
                    <li><a href="chat.html">Chat</a></li>
                </ul>
            </nav>
            <div class="sidebar-footer">
                <a href="creator_hub.html" class="btn btn-secondary">Switch to Creator Space</a>
                <div id="user-profile">
                    <p>Connected as: <strong id="username-display"></strong></p>
                </div>
            </div>
        </aside>

        <main id="main-content">
            <div id="creator-profile-header">
                <img id="creator-avatar" src="" alt="Creator avatar" class="creator-avatar-large">
                <div>
                    <h1 id="creator-name">Loading...</h1>
                    <p id="creator-bio">Loading bio...</p>
                </div>
            </div>

            <div class="profile-content">
                <h2>Tiers</h2>
                <p>Creator's membership tiers will be displayed here.</p>
                
                <h2>Products</h2>
                <p>Creator's digital products will be displayed here.</p>
            </div>
        </main>
    </div>

    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', async () => {
            // --- 1. CHECK USER AUTHENTICATION ---
            const userDisplay = document.getElementById('username-display');
            const piUserString = sessionStorage.getItem('piUser');
            if (!piUserString) {
                window.location.href = 'index.html';
                return;
            }
            const piUser = JSON.parse(piUserString);
            userDisplay.textContent = piUser.username;

            // --- 2. GET CREATOR ID FROM URL ---
            const params = new URLSearchParams(window.location.search);
            const creatorId = params.get('id');

            if (!creatorId) {
                document.getElementById('main-content').innerHTML = "<h1>Error: Creator ID not found in URL.</h1>";
                return;
            }

            // **IMPORTANT**: PASTE YOUR FIREBASE CONFIGURATION OBJECT HERE
        const firebaseConfig = {
            apiKey: "AIzaSyAJpReP6wVK925owZPC2U3J-Lv1fT7QKI4",
            authDomain: "evoque-app.firebaseapp.com",
            projectId: "evoque-app",
            storageBucket: "evoque-app.firebasestorage.app",
            messagingSenderId: "790735748571",
            appId: "1:790735748571:web:1938b35b04ef1c3a92fbfe",
            measurementId: "G-DG6WWPYQ3Z"
        };
            if (!firebase.apps.length) {
                firebase.initializeApp(firebaseConfig);
            }
            const db = firebase.firestore();

            // --- 4. FETCH SPECIFIC CREATOR'S DATA ---
            try {
                const docRef = db.collection("creators").doc(creatorId);
                const docSnap = await docRef.get();

                if (docSnap.exists) {
                    const creator = docSnap.data();
                    // Populate the page with the creator's data
                    document.getElementById('creator-name').textContent = creator.name;
                    document.getElementById('creator-bio').textContent = creator.bio;
                    document.getElementById('creator-avatar').src = creator.profileImage;
                } else {
                    document.getElementById('main-content').innerHTML = "<h1>Creator not found.</h1>";
                }
            } catch (error) {
                console.error("Error fetching creator profile: ", error);
                document.getElementById('main-content').innerHTML = "<h1>Error loading profile.</h1>";
            }
        });
    </script>
</body>
</html>
