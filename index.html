<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evoque - Connect</title>
    <script>
        (function() {
            const theme = localStorage.getItem('theme') || 'dark';
            if (theme === 'light') {
                document.documentElement.setAttribute('data-theme', 'light');
            }
        })();
    </script>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div id="login-page">
        <img src="images/evoque-logo.png" alt="Evoque Logo" class="logo">
        <h1>Welcome to Evoque</h1>
        <p>The ultimate launchpad for creators on the Pi Network. Connect your wallet to begin.</p>
        <button id="pi-connect-btn" class="btn btn-primary">Connect with Pi</button>
        <p id="auth-status" class="hidden"></p>
    </div>

    <script src="https://sdk.minepi.com/pi-sdk.js"></script>
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.10/firebase-app.js";

        const connectButton = document.getElementById('pi-connect-btn');
        const authStatus = document.getElementById('auth-status');

             const firebaseConfig = {
  apiKey: "AIzaSyAJpReP6wVK925owZPC2U3J-Lv1fT7QKI4",
  authDomain: "evoque-app.firebaseapp.com",
  projectId: "evoque-app",
  storageBucket: "evoque-app.firebasestorage.app",
  messagingSenderId: "790735748571",
  appId: "1:790735748571:web:1938b35b04ef1c3a92fbfe",
  measurementId: "G-DG6WWPYQ3Z"
};
        
        try {
            initializeApp(firebaseConfig);
        } catch(e) {
            authStatus.textContent = "Error initializing. Please refresh.";
            authStatus.classList.remove('hidden');
        }
        
        try {
            Pi.init({ version: "2.0", sandbox: true });
        } catch (err) { console.error("Pi SDK failed", err); }

        async function authenticateWithPi() {
            authStatus.textContent = 'Authenticating...';
            authStatus.classList.remove('hidden');
            try {
                const scopes = ['username', 'payments'];
                const authResult = await Pi.authenticate(scopes, () => {});
                sessionStorage.setItem('piUser', JSON.stringify(authResult.user));
                window.location.href = 'dashboard.html';
            } catch (err) {
                authStatus.textContent = `Authentication failed. Please try again.`;
            }
        }
        if (connectButton) {
            connectButton.addEventListener('click', authenticateWithPi);
        }
    </script>
</body>
</html>